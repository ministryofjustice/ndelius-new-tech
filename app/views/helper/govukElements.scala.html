@(elements: helper.FieldElements)

@htmlLines = @{elements.input.body.split("\n").map(_.trim).filterNot(_.isEmpty)}

@if(elements.input.body.contains("type=\"checkbox\"")) {
  @govukInfoErrors(elements)
  <div class="multiple-choice" @for((key, value) <- elements.args if !key.name.startsWith("_")) { @{key.name}=@{value} }>
    <input class="@elements.args.get('class)" type="checkbox" role="checkbox" id="@elements.id" name="@elements.field.name" value="true" @if(Boolean.parseBoolean(elements.field.value.getOrElse("false"))) { checked="checked" } aria-checked="@Boolean.parseBoolean(elements.field.value.getOrElse("false"))" aria-described-by="@elements.id-error" @if(elements.args.get('required)) {aria-required="@elements.args.get('required)"} />
    <label for="@elements.id">
        <span class="form-label-bold">@elements.label</span>
    </label>
  </div>
  <div class="clearfix"></div>
  <div class="margin-top"></div>
} else if(elements.input.body.contains("type=\"radio\"")) {
    <div class="form-group@if(elements.hasErrors) { form-group-error}">
        @htmlLines.init.tail.grouped(2).map(_.mkString).map { radioAndLabel =>
            <div class="multiple-choice" @for((key, value) <- elements.args if !key.name.startsWith("_")) { @{key.name}=@{value} }>
                @Html(radioAndLabel.replace("checked=\"checked\"", "checked=\"checked\" aria-checked=\"checked\""))
            </div>
        }
        @govukInfoErrors(elements)
    </div>
} else {
  <div class="form-group@if(elements.hasErrors) { form-group-error}">
    @govukLabel(elements)
    @if(elements.input.body.contains("textarea id=")) {
      <span id="@elements.id-autosave_error" class="autosave-error-message error-message js-hidden" aria-hidden="true">We can't currently save your report as the service is unavailable</span>
      <span>
        <div class="text-area-editor @elements.args.get('class)@if(elements.hasErrors) { form-control-error}"  role="textbox" id="@elements.id"                             @for((key, value) <- elements.args if !key.name.startsWith("_")) { @{key.name}=@{value} } aria-described-by="@elements.id-error" @if(elements.args.get('required)) {aria-required="@elements.args.get('required)"}>
        @Html(elements.field.value.getOrElse(""))
        </div>
        <input type="hidden" name="@elements.field.name" value="@elements.field.value">

        @if(elements.args.get(Symbol("data-limit"))) {
            <div class="pull-left js-hidden" id="@elements.id-countHolder">
                <p class="form-hint" id="@elements.id-count"></p>
            </div>
            <div class="clearfix"></div>
        }

      </span>
        <script>
            @elements.field.name = new Quill('#@elements.id', {
              placeholder: "@if(elements.args.get('placeholder)) {@elements.args.get('placeholder)} else {Start typing here...}",
              theme: 'snow',
              formats: ['bold', 'italic', 'underline', 'list', 'blockquote', 'indent'],
              modules: {
                toolbar: [
                    ['bold', 'italic', 'underline'],
                    ['blockquote', 'indent'],
                    [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                    ['clean']
                 ]
              }
            })
            @(elements.field.name).on('text-change', function(delta, oldDelta, source) {
              if (source == 'user') {
                if (@(elements.field.name).getText().replace(/^\s+|\s+$/gm,'')) {
                    $("input[name='@elements.field.name']").val(@(elements.field.name).root.innerHTML.replace(/<br>/gm,'<br/>'))
                } else {
                    $("input[name='@elements.field.name']").val('')
                }
              }
            })


        </script>
    } else if(elements.input.body.contains("select id=")) {
      <select class="form-control @elements.args.get('class)@if(elements.hasErrors) { form-control-error}" id="@elements.id" name="@elements.field.name">
          @htmlLines.filter(_.startsWith("<option ")).map(Html(_))
      </select>
    } else {
      <span>
        <input class="form-control @elements.args.get('class)@if(elements.hasErrors) { form-control-error}" type="text" role="textbox" placeholder="@elements.args.get('placeholder)" id="@elements.id" name="@elements.field.name" value="@elements.field.value" maxlength="250" aria-described-by="@elements.id-error" @if(elements.args.get('required)) {aria-required="@elements.args.get('required)"} />
      </span>
    }
  </div>
}
